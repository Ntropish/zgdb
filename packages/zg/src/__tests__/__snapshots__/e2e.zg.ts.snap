// Generated by ZG. Do not edit.

import { ZgDatabase, ZgBaseNode, ZgAuthContext } from '@tsmk/zg-client';
import * as LowLevel from './schema_generated.js';

// --- Interfaces ---
export interface ITestEntity {
  id: string;
  value: number;
}

// --- Node Classes ---
export class TestEntityNode extends ZgBaseNode<LowLevel.TestEntity> {
  // --- Fields ---
  get id(): string {
    return this.fbb.id();
  }

  get value(): number {
    return this.fbb.value();
  }

  // --- Relationships ---
  // (to be implemented)
}

// --- Database Class ---
export class ZgClient {
  private db: ZgDatabase;
  private authContext: ZgAuthContext | null = null;

  constructor(config: any) {
    this.db = new ZgDatabase(config);
  }

  setAuthContext(context: ZgAuthContext) {
    this.authContext = context;
  }

  get testEntitys() {
    return {
      get: async (id: string): Promise<TestEntityNode | null> => {
        if (!this.authContext) throw new Error("Auth context not set");
        // No 'read' auth rules defined for TestEntity
        const result = await this.db.get<LowLevel.TestEntity, TestEntityNode>('TestEntity', id, (db, fbb, ac) => new TestEntityNode(db, fbb, ac));
        return result;
      },
      create: async (data: Partial<ITestEntity>>): Promise<TestEntityNode> => {
        if (!this.authContext) throw new Error("Auth context not set");
        // No 'create' auth rules defined for TestEntity
        return this.db.create<LowLevel.TestEntity, TestEntityNode>('TestEntity', data, (db, fbb, ac) => new TestEntityNode(db, fbb, ac));
      },
      update: async (id: string, data: Partial<ITestEntity>>): Promise<TestEntityNode> => {
        if (!this.authContext) throw new Error("Auth context not set");
        // No 'update' auth rules defined for TestEntity
        return this.db.update<LowLevel.TestEntity, TestEntityNode>('TestEntity', id, data, (db, fbb, ac) => new TestEntityNode(db, fbb, ac));
      },
      delete: async (id: string): Promise<void> => {
        if (!this.authContext) throw new Error("Auth context not set");
        // No 'delete' auth rules defined for TestEntity
        return this.db.delete('TestEntity', id);
      }
    };
  }
}

export function createZgClient(config: any): ZgClient {
  return new ZgClient(config);
}
